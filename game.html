<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Coffee Catch</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
html,body{
  margin:0;
  padding:0;
  background:#0f0f12;
  height:100%;
  display:flex;
  justify-content:center;
  align-items:center;
  font-family:"Segoe UI", Roboto, Helvetica, Arial, sans-serif;
}
.container{
  position:relative;
  width:100%;
  height:100%;
  display:flex;
  flex-direction:column;
  align-items:center;
}
canvas{
  background:linear-gradient(#1d2230,#0f0f12);
  border:2px solid #333;
  border-radius:8px;
  touch-action:none;
  flex:1;
}
.overlay{
  position:absolute;
  top:0;left:0;
  width:100%;height:100%;
  background:rgba(0,0,0,.85);
  display:flex;
  justify-content:center;
  align-items:center;
  flex-direction:column;
  color:#fff;
  text-align:center;
  padding:20px;
  box-sizing:border-box;
}
.btn{
  background:#ffb84d;
  border:none;
  padding:10px 20px;
  font-size:18px;
  font-weight:bold;
  border-radius:6px;
  cursor:pointer;
  color:#000;
  margin-top:10px;
}
.controls{
  display:flex;
  width:100%;
}
.ctrl-btn{
  flex:1;
  background:rgba(255,255,255,0.1);
  color:#fff;
  font-size:5vw;
  padding:15px;
  border:none;
}
.ctrl-btn:active{background:rgba(255,255,255,0.3)}
ul{
  text-align:left;
  max-width:300px;
  padding-left:20px;
}
</style>
</head>
<body>
<div class="container">
<canvas id="c"></canvas>
<div class="controls">
  <button class="ctrl-btn" id="leftBtn">‚ü∏</button>
  <button class="ctrl-btn" id="rightBtn">‚üπ</button>
</div>

<!-- Start overlay -->
<div class="overlay" id="startOverlay">
  <h2>How to Play</h2>
  <ul>
    <li>Move the cup with buttons or ‚Üê/‚Üí keys</li>
    <li>Catch ü´ò beans to score points</li>
    <li>üíÄ skulls cost 1 life</li>
    <li>üí£ bombs end the game instantly</li>
    <li>Game ends when lives reach 0 or you catch a bomb</li>
  </ul>
  <button class="btn" id="startBtn">Start Game</button>
</div>

<!-- Game over overlay -->
<div class="overlay" id="over" style="display:none;background:rgba(0,0,0,.6)">
  <div id="final" style="font-size:22px;margin-bottom:10px;">Game Over</div>
  <button class="btn" id="again">Play Again</button>
</div>
</div>

<script>
const canvas = document.getElementById('c');
const ctx = canvas.getContext('2d');
let cup = {x:0,y:0,w:0,h:0,s:0};
let items=[],score,lives,go,st,si,fs,run,ml,mr;

function resizeCanvas(){
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight - document.querySelector('.controls').offsetHeight;
  cup.w = canvas.width * 0.12;
  cup.h = cup.w * 0.6;
  cup.s = canvas.width * 0.012;
  cup.x = canvas.width/2;
  cup.y = canvas.height - cup.h*1.5;
}
window.addEventListener('resize', resizeCanvas);

function reset(){
  items=[];score=0;lives=3;go=0;st=0;si=1000;fs=canvas.height*0.003;
  cup.x = canvas.width/2;
  run=1;document.getElementById('over').style.display='none';
}

function spawn(){
  let hc=Math.min(.4+score*.015,.8),
      t=Math.random()<hc?(Math.random()<.8?'skull':'bomb'):'bean';
  items.push({x:Math.random()*(canvas.width-30)+15,y:-20,t});
}

function drawCup(){
  ctx.strokeStyle='#fff';ctx.lineWidth=2;
  ctx.strokeRect(cup.x-cup.w/2,cup.y-cup.h/2,cup.w,cup.h);
  ctx.fillStyle='#6b4226';
  ctx.fillRect(cup.x-cup.w/2+2,cup.y-cup.h/2+2,cup.w-4,cup.h/3);
  ctx.beginPath();
  ctx.arc(cup.x+cup.w/2,cup.y,cup.w/4,Math.PI/4,-Math.PI/4,1);
  ctx.stroke();
}

function drawItems(){
  ctx.font=`${canvas.width*0.06}px sans-serif`;
  ctx.textAlign='center';
  ctx.textBaseline='middle';
  items.forEach(it=>{
    ctx.shadowColor='rgba(0,0,0,.4)';
    ctx.shadowBlur=4;
    ctx.fillText(it.t=='bean'?'ü´ò':it.t=='bomb'?'üí£':'üíÄ',it.x,it.y);
    ctx.shadowBlur=0;
  });
}

function update(){
  items.forEach(it=>it.y+=fs);
  items=items.filter(it=>{
    if(it.y>canvas.height+20) return 0;
    if(it.y+12>cup.y-cup.h/2 && it.y-12<cup.y+cup.h/2 &&
       it.x>cup.x-cup.w/2 && it.x<cup.x+cup.w/2){
      if(it.t=='bean') score++;
      else if(it.t=='skull'){ if(--lives<=0) go=1; }
      else go=1;
      return 0;
    }
    return 1;
  });
}

function hud(){
  ctx.fillStyle='#fff';
  ctx.font=`${canvas.width*0.04}px sans-serif`;
  ctx.textAlign='left';
  ctx.fillText('Score:'+score,10,30);
  ctx.textAlign='right';
  ctx.fillText('Lives:'+lives,canvas.width-10,30);
}

function loop(){
  if(!run) return;
  if(go){
    document.getElementById('final').textContent=`Game Over ‚Äî Score: ${score}`;
    document.getElementById('over').style.display='flex';
    run=0;return;
  }
  ctx.clearRect(0,0,canvas.width,canvas.height);
  if(ml) cup.x-=cup.s;
  if(mr) cup.x+=cup.s;
  cup.x=Math.max(cup.w/2,Math.min(canvas.width-cup.w/2,cup.x));
  st+=16.67;
  if(st>si){
    spawn();st=0;
    if(si>300) si-=10;
    fs+=canvas.height*0.00005;
  }
  update();drawItems();drawCup();hud();
  requestAnimationFrame(loop);
}

onkeydown=e=>{
  if(e.key=='ArrowLeft'||e.key=='a') ml=1;
  if(e.key=='ArrowRight'||e.key=='d') mr=1;
};
onkeyup=e=>{
  if(e.key=='ArrowLeft'||e.key=='a') ml=0;
  if(e.key=='ArrowRight'||e.key=='d') mr=0;
};

leftBtn.onmousedown=()=>ml=1;
leftBtn.onmouseup=()=>ml=0;
leftBtn.ontouchstart=e=>{e.preventDefault();ml=1};
leftBtn.ontouchend=()=>ml=0;

rightBtn.onmousedown=()=>mr=1;
rightBtn.onmouseup=()=>mr=0;
rightBtn.ontouchstart=e=>{e.preventDefault();mr=1};
rightBtn.ontouchend=()=>mr=0;

again.onclick=()=>{reset();requestAnimationFrame(loop)};
startBtn.onclick=()=>{document.getElementById('startOverlay').style.display='none';reset();requestAnimationFrame(loop)};

resizeCanvas();
</script>
</body>
</html>